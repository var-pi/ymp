#!/usr/bin/env python3

import subprocess
import sys
from pathlib import Path

def main():
    if len(sys.argv) < 2:
        print("Usage: yd <URL>")
        return
    
    url = sys.argv[1]
    library_dir = Path.home() / ".ymp-store" / "library"
    
    # Ensure library directory exists
    library_dir.mkdir(parents=True, exist_ok=True)
    
    # Run yt-dlp command
    cmd = [
        "yt-dlp",
        "-x",
        "--no-playlist",
        "-o", f"{library_dir}/%(title)s.%(ext)s",
        "--audio-format", "opus",
        url
    ]
    
    subprocess.run(cmd)

if __name__ == "__main__":
    main()
